<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="EdgeWallet - RFID Payment System Dashboard">
  <title>EdgeWallet - RFID Payment Dashboard</title>
  
  <!-- Stylesheets -->
  <link rel="stylesheet" href="style.css">
  <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600&display=swap" rel="stylesheet">
  
  <!-- Icons -->
  <script src="https://unpkg.com/feather-icons"></script>
  
  <!-- Scripts -->
  <script src="https://cdn.socket.io/4.7.2/socket.io.min.js"></script>
  <script src="config.js"></script>
</head>

<body>
  <div class="dashboard">
    
    <!-- ============================================ -->
    <!-- SIDEBAR NAVIGATION -->
    <!-- ============================================ -->
    <aside class="sidebar">
      
      <!-- Sidebar Header -->
      <div class="sidebar-header">
        <div class="sidebar-title-row">
          <div>
            <h1>Edge<span>Wallet</span></h1>
            <p class="sidebar-subtitle">RFID Payment System</p>
          </div>
          <div class="connection-indicator" title="WebSocket Connection Status">
            <span class="indicator-dot" id="connection-indicator"></span>
          </div>
        </div>
      </div>

      <!-- Navigation Menu -->
      <nav class="sidebar-nav" role="navigation" aria-label="Main navigation">
        <a href="#admin" class="nav-item active" aria-current="page" data-view="admin">
          <span class="nav-icon" aria-hidden="true">
            <i data-feather="credit-card"></i>
          </span>
          <span class="nav-text">Admin – Top-Up</span>
        </a>
        <a href="#cashier" class="nav-item" data-view="cashier">
          <span class="nav-icon" aria-hidden="true">
            <i data-feather="shopping-bag"></i>
          </span>
          <span class="nav-text">Cashier – Payment</span>
        </a>
      </nav>

      <!-- System Status Monitor -->
      <div class="system-status">
        <h3>System Status</h3>
        
        <div class="status-item">
          <div class="status-label">
            <span class="status-dot" id="mqtt-status" aria-hidden="true"></span>
            MQTT Broker
          </div>
          <div class="status-value" id="mqtt-status-text">Connecting...</div>
        </div>
        
        <div class="status-item">
          <div class="status-label">
            <span class="status-dot" id="backend-status" aria-hidden="true"></span>
            Backend Server
          </div>
          <div class="status-value" id="backend-status-text">Connecting...</div>
        </div>
        
        <div class="status-item">
          <div class="status-label">
            <span class="status-dot" id="db-status" aria-hidden="true"></span>
            Database
          </div>
          <div class="status-value" id="db-status-text">Unknown</div>
        </div>
      </div>

      <!-- Sidebar Footer -->
      <div class="sidebar-footer">
        <div class="team-info">
          <span class="team-label">Team ID</span>
          <span class="team-value">quantum_bitflip_0xDEAD</span>
        </div>
        <div class="uptime">
          <span class="uptime-label">Uptime</span>
          <span class="uptime-value" id="uptime">00:00:00</span>
        </div>
      </div>
      
    </aside>

    <!-- ============================================ -->
    <!-- MAIN CONTENT AREA -->
    <!-- ============================================ -->
    <main class="main-content" role="main">
      
      <!-- Quick Statistics Grid (shared) -->
      <section class="stats-grid" aria-label="Quick statistics">
        
        <div class="stat-card-main">
          <div class="stat-icon stat-icon-purple" aria-hidden="true">
            <i data-feather="credit-card"></i>
          </div>
          <div class="stat-content">
            <div class="stat-label">Total Cards</div>
            <div class="stat-value" id="total-cards">0</div>
          </div>
        </div>
        
        <div class="stat-card-main">
          <div class="stat-icon stat-icon-blue" aria-hidden="true">
            <i data-feather="activity"></i>
          </div>
          <div class="stat-content">
            <div class="stat-label">Today's Transactions</div>
            <div class="stat-value" id="today-transactions">0</div>
          </div>
        </div>
        
        <div class="stat-card-main">
          <div class="stat-icon stat-icon-green" aria-hidden="true">
            <i data-feather="dollar-sign"></i>
          </div>
          <div class="stat-content">
            <div class="stat-label">Total Volume</div>
            <div class="stat-value" id="total-volume">$0.00</div>
          </div>
        </div>
        
        <div class="stat-card-main">
          <div class="stat-icon stat-icon-orange" aria-hidden="true">
            <i data-feather="zap"></i>
          </div>
          <div class="stat-content">
            <div class="stat-label">Avg. Transaction</div>
            <div class="stat-value" id="avg-transaction">$0.00</div>
          </div>
        </div>
        
      </section>

      <!-- ============================================ -->
      <!-- ADMIN VIEW (TOP-UP) -->
      <!-- ============================================ -->
      <div id="admin-view" class="content-grid">
        
        <!-- ACTIVE CARD SECTION -->
        <section class="glass-card card-status-section" aria-labelledby="active-card-heading">
          <h3 id="active-card-heading">Active Card</h3>
          
          <!-- Visual Card Display -->
          <div class="card-visual-container">
            <div id="card-visual" class="card-visual" role="img" aria-label="RFID card visualization">
              <div class="card-chip" aria-hidden="true"></div>
              <div class="card-number" aria-label="Card number">**** **** **** ****</div>
              <div class="card-details">
                <div class="card-holder-group">
                  <span class="card-label">CARD HOLDER</span>
                  <span id="card-uid-display" class="card-value">NO CARD</span>
                </div>
                <div class="card-balance-group">
                  <span class="card-label">BALANCE</span>
                  <span id="card-balance-display" class="card-value">$0.00</span>
                </div>
              </div>
            </div>
          </div>
          
          <!-- Card Status Information -->
          <div id="status-display" class="status-content">
            <div class="status-placeholder">
              <span aria-live="polite">Scan an RFID card to begin...</span>
            </div>
          </div>
        </section>

        <!-- TOP UP SECTION -->
        <section class="glass-card topup-section" aria-labelledby="topup-heading">
          <h3 id="topup-heading">Top Up Card</h3>
          
          <form id="topup-form" aria-label="Card top-up form">
            
            <div class="input-group">
              <label for="uid">Card UID</label>
              <input 
                type="text" 
                id="uid" 
                name="uid"
                placeholder="UID auto-populated" 
                readonly
                aria-describedby="uid-help"
              >
              <small id="uid-help" class="input-help" style="display:none;">
                Card UID will be auto-populated when a card is scanned
              </small>
            </div>
            
            <div class="input-group">
              <label for="holderName">Card Holder Name</label>
              <input 
                type="text" 
                id="holderName" 
                name="holderName"
                placeholder="Enter name for new cards"
                autocomplete="name"
                aria-describedby="name-help"
              >
              <small id="name-help" class="input-help" style="display:none;">
                Required for new cards, auto-filled for existing cards
              </small>
            </div>
            
            <div class="input-group">
              <label for="amount">Amount ($)</label>
              <input 
                type="number" 
                id="amount" 
                name="amount"
                placeholder="0.00" 
                step="0.01"
                min="0.01"
                aria-describedby="amount-help"
              >
              <small id="amount-help" class="input-help" style="display:none;">
                Enter the amount to add to the card balance
              </small>
            </div>
            
            <button 
              type="submit"
              id="topup-btn" 
              disabled
              aria-label="Confirm top-up transaction"
            >
              Confirm Top Up
            </button>
            
          </form>
        </section>

        <!-- TRANSACTION HISTORY SECTION -->
        <section class="glass-card transaction-section" aria-labelledby="transaction-heading">
          <h3 id="transaction-heading">Transaction History</h3>
          
          <div 
            id="transaction-history" 
            class="transaction-list"
            role="list"
            aria-label="Transaction history list"
            aria-live="polite"
          >
            <!-- Transactions will be dynamically inserted here -->
            <div class="status-placeholder">
              No transactions yet
            </div>
          </div>
        </section>
        
      </div>

      <!-- ============================================ -->
      <!-- CASHIER VIEW (PAYMENT) -->
      <!-- ============================================ -->
      <div id="cashier-view" class="content-grid" style="display:none;">
        
        <section class="glass-card topup-section" aria-labelledby="cashier-heading">
          <h3 id="cashier-heading">Cashier – Payment</h3>
          
          <form id="cashier-form" aria-label="Cashier payment form">
            
            <div class="input-group">
              <label for="cashier-uid">Card UID</label>
              <input 
                type="text" 
                id="cashier-uid" 
                name="cashier-uid"
                placeholder="Scan card to autofill" 
                readonly
              >
            </div>

            <div class="input-group">
              <label>Previous Balance</label>
              <div id="cashier-previous-balance" class="data-value" style="color:#6366f1;">$0.00</div>
            </div>

            <div class="input-group">
              <label for="cashier-product">Product</label>
              <select id="cashier-product" name="cashier-product">
                <option value="">Select a product</option>
              </select>
            </div>

            <div class="input-group">
              <label for="cashier-quantity">Quantity</label>
              <input 
                type="number" 
                id="cashier-quantity" 
                name="cashier-quantity"
                value="1"
                min="1"
              >
            </div>

            <div class="input-group">
              <label>Total</label>
              <div id="cashier-total" class="data-value" style="color:#22c55e;">$0.00</div>
            </div>

            <button 
              type="submit"
              id="cashier-pay-btn" 
              disabled
            >
              Pay
            </button>

            <div id="cashier-result" class="status-content" style="margin-top:16px;"></div>
            
          </form>
        </section>
      </div>
      
    </main>
    
  </div>

  <!-- Main Application Script -->
  <script src="app.js"></script>
  
  <!-- Initialize Feather Icons -->
  <script>
    feather.replace();
  </script>
</body>

</html>