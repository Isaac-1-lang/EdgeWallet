<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="EdgeWallet - RFID Payment System Dashboard">
  <title>EdgeWallet - RFID Payment Dashboard</title>

  <!-- Stylesheets -->
  <link rel="stylesheet" href="style.css">
  <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700&display=swap" rel="stylesheet">

  <!-- Icons -->
  <script src="https://unpkg.com/feather-icons"></script>

  <!-- Scripts -->
  <script src="https://cdn.socket.io/4.7.2/socket.io.min.js"></script>
  <script src="config.js"></script>
</head>

<body>
  <!-- Interactive Particle Background -->
  <canvas id="particle-canvas"></canvas>

  <!-- Confetti Canvas -->
  <canvas id="confetti-canvas"></canvas>

  <!-- Toast Notification Container -->
  <div id="toast-container" class="toast-container" aria-live="polite"></div>

  <div class="dashboard">

    <!-- ============================================ -->
    <!-- SIDEBAR NAVIGATION -->
    <!-- ============================================ -->
    <aside class="sidebar">

      <!-- Sidebar Header -->
      <div class="sidebar-header">
        <div class="sidebar-title-row">
          <div>
            <h1>Edge<span>Wallet</span></h1>
            <p class="sidebar-subtitle">RFID Payment System</p>
          </div>
          <div class="connection-indicator" title="WebSocket Connection Status">
            <span class="indicator-dot" id="connection-indicator"></span>
          </div>
        </div>
      </div>

      <!-- Navigation Menu -->
      <nav class="sidebar-nav" role="navigation" aria-label="Main navigation">
        <a href="#admin" class="nav-item active" aria-current="page" data-view="admin">
          <span class="nav-icon" aria-hidden="true">
            <i data-feather="credit-card"></i>
          </span>
          <span class="nav-text">Admin Portal</span>
        </a>
        <a href="#marketplace" class="nav-item" data-view="marketplace">
          <span class="nav-icon" aria-hidden="true">
            <i data-feather="shopping-bag"></i>
          </span>
          <span class="nav-text">Marketplace</span>
        </a>
        <a href="#cashier" class="nav-item" data-view="cashier">
          <span class="nav-icon" aria-hidden="true">
            <i data-feather="shopping-cart"></i>
          </span>
          <span class="nav-text">Cashier Portal</span>
        </a>
      </nav>

      <!-- System Status Monitor -->
      <div class="system-status">
        <h3>System Status</h3>

        <div class="status-item">
          <div class="status-label">
            <span class="status-dot" id="mqtt-status" aria-hidden="true"></span>
            MQTT Broker
          </div>
          <div class="status-value" id="mqtt-status-text">Connecting...</div>
        </div>

        <div class="status-item">
          <div class="status-label">
            <span class="status-dot" id="backend-status" aria-hidden="true"></span>
            Backend Server
          </div>
          <div class="status-value" id="backend-status-text">Connecting...</div>
        </div>

        <div class="status-item">
          <div class="status-label">
            <span class="status-dot" id="db-status" aria-hidden="true"></span>
            Database
          </div>
          <div class="status-value" id="db-status-text">Unknown</div>
        </div>
      </div>

      <!-- Sidebar Footer -->
      <div class="sidebar-footer">
        <div class="team-info">
          <span class="team-label">Team ID</span>
          <span class="team-value">quantum_bitflip_0xDEAD</span>
        </div>
        <div class="uptime">
          <span class="uptime-label">Uptime</span>
          <span class="uptime-value" id="uptime">00:00:00</span>
        </div>
      </div>

    </aside>

    <!-- ============================================ -->
    <!-- MAIN CONTENT AREA -->
    <!-- ============================================ -->
    <main class="main-content" role="main">

      <!-- Live Activity Ticker -->
      <div class="live-ticker" id="live-ticker">
        <div class="ticker-label">
          <span class="ticker-dot"></span>
          LIVE
        </div>
        <div class="ticker-track">
          <div class="ticker-content" id="ticker-content">
            <span class="ticker-item">Waiting for activity...</span>
          </div>
        </div>
      </div>

      <!-- Quick Statistics Grid (shared) -->
      <section class="stats-grid" aria-label="Quick statistics">

        <div class="stat-card-main">
          <div class="stat-icon stat-icon-purple" aria-hidden="true">
            <i data-feather="credit-card"></i>
          </div>
          <div class="stat-content">
            <div class="stat-label">Total Cards</div>
            <div class="stat-value" id="total-cards">0</div>
          </div>
        </div>

        <div class="stat-card-main">
          <div class="stat-icon stat-icon-blue" aria-hidden="true">
            <i data-feather="activity"></i>
          </div>
          <div class="stat-content">
            <div class="stat-label">Today's Transactions</div>
            <div class="stat-value" id="today-transactions">0</div>
          </div>
        </div>

        <div class="stat-card-main">
          <div class="stat-icon stat-icon-green" aria-hidden="true">
            <i data-feather="dollar-sign"></i>
          </div>
          <div class="stat-content">
            <div class="stat-label">Total Volume</div>
            <div class="stat-value" id="total-volume">$0.00</div>
          </div>
        </div>

        <div class="stat-card-main">
          <div class="stat-icon stat-icon-orange" aria-hidden="true">
            <i data-feather="zap"></i>
          </div>
          <div class="stat-content">
            <div class="stat-label">Avg. Transaction</div>
            <div class="stat-value" id="avg-transaction">$0.00</div>
          </div>
        </div>

      </section>

      <!-- ============================================ -->
      <!-- ADMIN VIEW (TOP-UP) -->
      <!-- ============================================ -->
      <div id="admin-view" class="content-grid">

        <!-- ACTIVE CARD SECTION with Mastercard -->
        <section class="glass-card card-status-section" aria-labelledby="active-card-heading">
          <h3 id="active-card-heading">Active Card</h3>

          <!-- Mastercard-style Visual Card (Flippable) -->
          <div class="card-visual-container">
            <div class="card-flipper" id="card-flipper">
              <!-- FRONT SIDE -->
              <div id="card-visual" class="card-visual card-front" role="img" aria-label="RFID card visualization">

                <!-- Top row: chip + contactless -->
                <div class="card-top-row">
                  <div class="card-chip"></div>
                  <div class="card-contactless">
                    <span></span>
                    <span></span>
                    <span></span>
                  </div>
                </div>

                <!-- Card number -->
                <div class="card-number">**** **** **** ****</div>

                <!-- Bottom row: holder + balance + brand -->
                <div class="card-details">
                  <div class="card-holder-group">
                    <span class="card-label">CARD HOLDER</span>
                    <span id="card-uid-display" class="card-value">NO CARD</span>
                  </div>
                  <div class="card-balance-group">
                    <span class="card-label">BALANCE</span>
                    <span id="card-balance-display" class="card-value">$0.00</span>
                  </div>
                  <div class="card-brand">
                    <div class="mc-circles">
                      <div class="circle"></div>
                      <div class="circle"></div>
                    </div>
                  </div>
                </div>
              </div>

              <!-- BACK SIDE -->
              <div class="card-visual card-back">
                <div class="card-back-stripe"></div>
                <div class="card-back-content">
                  <div class="card-back-title">Recent Activity</div>
                  <div class="card-back-transactions" id="card-back-transactions">
                    <div class="card-back-empty">No transactions yet</div>
                  </div>
                </div>
                <div class="card-back-footer">
                  <span class="card-back-brand">Edge<span>Wallet</span></span>
                  <span class="card-back-rfid">RFID ‚Ä¢ NFC</span>
                </div>
              </div>
            </div>
          </div>

          <!-- Card Status Information -->
          <div id="status-display" class="status-content">
            <div class="status-placeholder">
              <span aria-live="polite">Scan an RFID card to begin...</span>
            </div>
          </div>
        </section>

        <!-- TOP UP SECTION -->
        <section class="glass-card topup-section" aria-labelledby="topup-heading">
          <h3 id="topup-heading">Top Up Card</h3>

          <form id="topup-form" aria-label="Card top-up form">

            <div class="input-group">
              <label for="uid">Card UID</label>
              <input type="text" id="uid" name="uid" placeholder="UID auto-populated" readonly
                aria-describedby="uid-help">
              <small id="uid-help" class="input-help" style="display:none;">
                Card UID will be auto-populated when a card is scanned
              </small>
            </div>

            <div class="input-group">
              <label for="holderName">Card Holder Name</label>
              <input type="text" id="holderName" name="holderName" placeholder="Enter name for new cards"
                autocomplete="name" aria-describedby="name-help">
              <small id="name-help" class="input-help" style="display:none;">
                Required for new cards, auto-filled for existing cards
              </small>
            </div>

            <div class="input-group">
              <label for="amount">Amount ($)</label>
              <input type="number" id="amount" name="amount" placeholder="0.00" step="0.01" min="0.01"
                aria-describedby="amount-help">
              <small id="amount-help" class="input-help" style="display:none;">
                Enter the amount to add to the card balance
              </small>
            </div>

            <button type="submit" id="topup-btn" disabled aria-label="Confirm top-up transaction">
              Confirm Top Up
            </button>

          </form>
        </section>

        <!-- TRANSACTION HISTORY SECTION -->
        <section class="glass-card transaction-section" aria-labelledby="transaction-heading">
          <h3 id="transaction-heading">Transaction History</h3>

          <div id="transaction-history" class="transaction-list" role="list" aria-label="Transaction history list"
            aria-live="polite">
            <div class="status-placeholder">
              No transactions yet
            </div>
          </div>
        </section>

      </div>

      <!-- ============================================ -->
      <!-- MARKETPLACE VIEW -->
      <!-- ============================================ -->
      <div id="marketplace-view" class="marketplace-view">

        <!-- Products area -->
        <div class="marketplace-main">
          <div class="glass-card">
            <h3>üõí Marketplace</h3>

            <!-- Category filtration tabs -->
            <div class="category-tabs" id="category-tabs">
              <button class="category-tab active" data-category="all">All</button>
            </div>

            <!-- Product grid -->
            <div class="marketplace-products" id="marketplace-products">
              <div class="status-placeholder">Loading products...</div>
            </div>
          </div>
        </div>

        <!-- Cart sidebar -->
        <div class="cart-section">
          <div class="cart-header">
            <h3>üõçÔ∏è Cart</h3>
            <span class="cart-badge" id="cart-badge">0</span>
          </div>

          <!-- Card info -->
          <div class="cart-card-info">
            <span class="cart-card-dot" id="cart-card-dot"></span>
            <span class="cart-card-text" id="cart-card-text">No card scanned</span>
          </div>

          <!-- Cart items -->
          <div class="cart-items" id="cart-items">
            <div class="cart-empty">
              <span class="cart-empty-icon">üõí</span>
              Add products to your cart
            </div>
          </div>

          <!-- Cart footer -->
          <div class="cart-footer">
            <div class="cart-total">
              <span class="cart-total-label">Total</span>
              <span class="cart-total-value" id="cart-total">$0.00</span>
            </div>
            <button class="cart-pay-btn" id="cart-pay-btn" disabled>
              Pay Now
            </button>
            <div id="marketplace-result"></div>
          </div>
        </div>

      </div>

      <!-- ============================================ -->
      <!-- CASHIER VIEW (QUICK PAY) -->
      <!-- ============================================ -->
      <div id="cashier-view" class="content-grid" style="display:none;">

        <section class="glass-card topup-section" aria-labelledby="cashier-heading">
          <h3 id="cashier-heading">Cashier ‚Äì Quick Pay</h3>

          <form id="cashier-form" aria-label="Cashier payment form">

            <div class="input-group">
              <label for="cashier-uid">Card UID</label>
              <input type="text" id="cashier-uid" name="cashier-uid" placeholder="Scan card to autofill" readonly>
            </div>

            <div class="input-group">
              <label>Previous Balance</label>
              <div id="cashier-previous-balance" class="data-value">$0.00</div>
            </div>

            <div class="input-group">
              <label for="cashier-product">Product</label>
              <select id="cashier-product" name="cashier-product">
                <option value="">Select a product</option>
              </select>
            </div>

            <div class="input-group">
              <label for="cashier-quantity">Quantity</label>
              <input type="number" id="cashier-quantity" name="cashier-quantity" value="1" min="1">
            </div>

            <div class="input-group">
              <label>Total</label>
              <div id="cashier-total" class="data-value">$0.00</div>
            </div>

            <button type="submit" id="cashier-pay-btn" disabled>
              Pay
            </button>

            <div id="cashier-result" class="status-content" style="margin-top:16px;"></div>

          </form>
        </section>
      </div>

    </main>

  </div>

  <!-- Main Application Script -->
  <script src="app.js"></script>

  <!-- Initialize Feather Icons -->
  <script>
    feather.replace();
  </script>
</body>

</html>